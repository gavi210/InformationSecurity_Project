# Vulnerabilities in the System
- Traffic between Application and Client is not encrypted, it should be made encrypted. 
Leverage the capabilities for TomCat and the servlets to encrypt communication.
link solution: https://stackoverflow.com/questions/53922416/how-to-set-https-for-java-servlet-application
 ... the main idea is to make tomcat accepting only https requests rather than http.
Look at Wireshark screen to notice that the communication was not encrypted and in plain text.
- Authorization and Authentication for the users submitting the requests. 

| Name                                | Description                                                                                                                                                                                            | Solution                                                                                                                                                                                                                                                                                           |
|-------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| Password sent around                | The password for a logged user is stored in the html page, it is hidden, but could be read from the page inspector. Anyone having access to the html page (man in the middle) could read the password  | Remove the password form the webpage, since it is useless                                                                                                                                                                                                                                          |
| Password is weak, no restrictions   | User could insert whatever password, that could be easily broken with brute-force attacks                                                                                                              | Enforce stronger password policy and allow only a maximum number of attempts per time interval                                                                                                                                                                                                     |
| Mail address regex is not specified | There is no check for ensuring that the email address is a mail address                                                                                                                                |                                                                                                                                                                                                                                                                                                    |
| HTTP                                | Since HTTP is used instead of HTTPS, the data being exchanged could be sniffed.                                                                                                                        | Adopt HTTPS communication to encrypt and hide the exchange of information. https://security.stackexchange.com/questions/83028/possibility-to-sniff-https-traffic-on-devices-without-installing-a-certificate : with wireshark try to sniff packets form the LAN: since encrypted are not readable. |
| Authorization and Authentication    | There is no mean to check whether the requests come from an authorized and trusted user.                                                                                                               | Add an authorization and authentication mechanisms. https://www.mulesoft.com/tcat/tomcat-ssl maybe useful to set up the HTTPs mechanism. SSL-mechanism could be used to ensure confidentiality during data exchange                                                                                |
| Authorization and Authentication    | Link: to provide filtering: https://stackoverflow.com/questions/13274279/authentication-filter-and-servlet-for-login/13276996#13276996                                                                 |                                                                                                                                                                                                                                                                                                    |
| SQL Injection                       | Inputs are not validated and the queries are subject to SQL Injection. In particular, the intent of the query could be changed                                                                         | Use Parametrized Queries, that make impossible to alter the query behavior.                                                                                                                                                                                                                        |
| Cross-Site Scripting Reflected      | Input submitted by the user could alter the application behavior. In example, user could use the username or other fields for scripting                                                                | JSoup to validate and sanitize each user provided information                                                                                                                                                                                                                                      |
| Cross-Site Scripting Stored         | Store Content in emails that is executed while printing back the email information.                                                                                                                    | JSoup to validate and sanitize each user provided information                                                                                                                                                                                                                                      |
| Request Forgery                     | Sniffing HTML page (man-in-the-middle) read the email address and user password. With this credentials, the attacker pretends to send emails as the real user would do.                                | Avoid that password is sniffed (remove it), and authenticate users with cookies                                                                                                                                                                                                                    |

XSS: prevention mechanisms: 
- https://stackoverflow.com/questions/63366287/i-am-not-sure-how-to-perform-html-escaping-in-my-java-project-to-prevent-xss : StringUtils
- https://owasp.org/www-project-java-encoder/ : Encoder From the OWASP association
- https://github.blog/2022-02-16-encoding-escaping-untrusted-data-prevent-injection-attacks/ : GitHub blog, talk about it in general
- https://stackoverflow.com/questions/3413297/how-to-sanitize-html-code-in-java-to-prevent-xss-attacks : StackOverflow reference goes mostly for OWASP solution.

HTTPS: secures the communication, then encryption to secure data storage: even if corrupted, the attacker cannot read data stored on the server (database).
Violation: tamper the sender by simulating being another person
Read the emails of another account
